<nav class="bg-blue-500 text-white px-6 py-4">
  <a href="/" class="text-lg font-bold">식도락</a>
  <ul class="flex justify-end">
    <li class="mr-4">
      <a
        id="login-nav"
        href="/login"
        style="display: none"
        class="hover:text-gray-300 transition duration-300 ease-in-out"
        onclick="redirectToLoginPage()"
        >로그인</a
      >
    </li>
    <li>
      <a
        id="logout-nav"
        href="#"
        style="display: none"
        class="hover:text-gray-300 transition duration-300 ease-in-out"
        onclick="confirmLogout()"
        >로그아웃</a
      >
    </li>
  </ul>
</nav>

<script>
  const token = localStorage.getItem("access_token");

  const logoutButton = document.getElementById("logout-nav");
  const loginButton = document.getElementById("login-nav");

  if (token) {
    fetch("/protected", {
      method: "GET",
      headers: {
        Authorization: `Bearer ${token}`, // JWT 헤더에 포함
      },
    })
      .then((response) => response.json())
      .then((data) => {
        // JWT가 localStorage에 있으면 로그인 상태로 간주
        logoutButton.style.display = "inline-block"; // 로그아웃 버튼 표시
      })
      .catch((error) => {
        console.error("Error:", error);
        loginButton.style.display = "inline-block"; // 로그인 버튼 표시
      });
  } else {
    loginButton.style.display = "inline-block"; // 로그인 버튼 표시
  }

  function redirectToLoginPage() {
    // 로그인 페이지로 이동합니다.
    window.location.href = "/login";
  }

  function confirmLogout() {
    // 로그아웃을 진행하기 전에 사용자에게 확인 메시지를 띄웁니다.
    var confirmLogout = confirm("정말 로그아웃 하시겠습니까?");
    if (confirmLogout) {
      // 사용자가 확인을 클릭한 경우, 로그아웃을 진행합니다.
      localStorage.removeItem("access_token");
      window.location.reload(); // 페이지 새로고침
    }
  }
</script>
